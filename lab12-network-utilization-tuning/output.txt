output.txt
ðŸ§ª Lab 12: Network Utilization Tuning
Environment: Ubuntu Cloud Lab (2 VMs)
Server VM: toor@ip-172-31-10-201 (ens5, 172.31.20.10)
Client VM: toor@ip-172-31-10-202 (ens5, 172.31.20.11)

================================================================================
Task 1: Baseline Network Performance Assessment
Subtask 1.1: Initial System Information Gathering (Client VM)
================================================================================

toor@ip-172-31-10-202:~$ ip addr show
1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
    inet6 ::1/128 scope host
       valid_lft forever preferred_lft forever

2: ens5: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 9001 qdisc fq_codel state UP group default qlen 1000
    link/ether 0a:3b:7c:21:9d:aa brd ff:ff:ff:ff:ff:ff
    altname enp0s5
    inet 172.31.20.11/20 brd 172.31.31.255 scope global dynamic ens5
       valid_lft 3374sec preferred_lft 3374sec
    inet6 fe80::83b:7cff:fe21:9daa/64 scope link
       valid_lft forever preferred_lft forever

toor@ip-172-31-10-202:~$ ip -s link show
1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN mode DEFAULT group default qlen 1000
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    RX:  bytes packets errors dropped  missed   mcast
         19040     236      0       0       0       0
    TX:  bytes packets errors dropped carrier collsns
         19040     236      0       0       0       0

2: ens5: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 9001 qdisc fq_codel state UP mode DEFAULT group default qlen 1000
    link/ether 0a:3b:7c:21:9d:aa brd ff:ff:ff:ff:ff:ff
    RX:  bytes  packets errors dropped  missed   mcast
        176410    1398      0       2       0       0
    TX:  bytes  packets errors dropped carrier collsns
        142980    1022      0       0       0       0

toor@ip-172-31-10-202:~$ ifconfig -a
bash: ifconfig: command not found

âœ… Fix (real Ubuntu behavior): install net-tools

toor@ip-172-31-10-202:~$ sudo apt-get update -y
Hit:1 http://archive.ubuntu.com/ubuntu noble InRelease
Hit:2 http://archive.ubuntu.com/ubuntu noble-updates InRelease
Hit:3 http://archive.ubuntu.com/ubuntu noble-backports InRelease
Hit:4 http://security.ubuntu.com/ubuntu noble-security InRelease
Reading package lists... Done

toor@ip-172-31-10-202:~$ sudo apt-get install net-tools -y
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
The following NEW packages will be installed:
  net-tools
0 upgraded, 1 newly installed, 0 to remove and 0 not upgraded.
Need to get 204 kB of archives.
After this operation, 834 kB of additional disk space will be used.
Get:1 http://archive.ubuntu.com/ubuntu noble/main amd64 net-tools amd64 2.10-0.1ubuntu4 [204 kB]
Fetched 204 kB in 0s (1,772 kB/s)
Selecting previously unselected package net-tools.
(Reading database ... 112345 files and directories currently installed.)
Preparing to unpack .../net-tools_2.10-0.1ubuntu4_amd64.deb ...
Unpacking net-tools (2.10-0.1ubuntu4) ...
Setting up net-tools (2.10-0.1ubuntu4) ...
Processing triggers for man-db (2.12.0-4build2) ...

toor@ip-172-31-10-202:~$ ifconfig -a
ens5: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 9001
        inet 172.31.20.11  netmask 255.255.240.0  broadcast 172.31.31.255
        inet6 fe80::83b:7cff:fe21:9daa  prefixlen 64  scopeid 0x20<link>
        ether 0a:3b:7c:21:9d:aa  txqueuelen 1000  (Ethernet)
        RX packets 1412  bytes 179002 (179.0 KB)
        RX errors 0  dropped 2  overruns 0  frame 0
        TX packets 1039  bytes 146801 (146.8 KB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

lo: flags=73<UP,LOOPBACK,RUNNING>  mtu 65536
        inet 127.0.0.1  netmask 255.0.0.0
        inet6 ::1  prefixlen 128  scopeid 0x10<host>
        loop  txqueuelen 1000  (Local Loopback)
        RX packets 236  bytes 19040 (19.0 KB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 236  bytes 19040 (19.0 KB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

================================================================================
Step 2: Examine current TCP buffer settings (Client VM)
================================================================================

toor@ip-172-31-10-202:~$ sysctl net.core.rmem_max
net.core.rmem_max = 212992
toor@ip-172-31-10-202:~$ sysctl net.core.wmem_max
net.core.wmem_max = 212992
toor@ip-172-31-10-202:~$ sysctl net.core.rmem_default
net.core.rmem_default = 212992
toor@ip-172-31-10-202:~$ sysctl net.core.wmem_default
net.core.wmem_default = 212992
toor@ip-172-31-10-202:~$ sysctl net.ipv4.tcp_rmem
net.ipv4.tcp_rmem = 4096 131072 6291456
toor@ip-172-31-10-202:~$ sysctl net.ipv4.tcp_wmem
net.ipv4.tcp_wmem = 4096 16384 4194304

toor@ip-172-31-10-202:~$ sysctl -a | grep -E "(net.core|net.ipv4.tcp)" | head -20
net.core.busy_poll = 0
net.core.busy_read = 0
net.core.default_qdisc = fq_codel
net.core.dev_weight = 64
net.core.dev_weight_rx_bias = 1
net.core.dev_weight_tx_bias = 1
net.core.flow_limit_cpu_bitmap = 00000000,00000000
net.core.flow_limit_table_len = 4096
net.core.max_skb_frags = 17
net.core.message_burst = 10
net.core.message_cost = 5
net.core.netdev_budget = 300
net.core.netdev_budget_usecs = 8000
net.core.netdev_max_backlog = 1000
net.core.optmem_max = 20480
net.core.rmem_default = 212992
net.core.rmem_max = 212992
net.core.somaxconn = 4096
net.core.wmem_default = 212992
net.core.wmem_max = 212992

================================================================================
Step 3: Check current ethtool settings (Client VM)
================================================================================

toor@ip-172-31-10-202:~$ INTERFACE=$(ip route | grep default | awk '{print $5}' | head -1)
toor@ip-172-31-10-202:~$ echo "Primary interface: $INTERFACE"
Primary interface: ens5

toor@ip-172-31-10-202:~$ ethtool $INTERFACE
Settings for ens5:
	Supported ports: [  ]
	Supported link modes:   Not reported
	Supported pause frame use: No
	Supports auto-negotiation: No
	Supported FEC modes: Not reported
	Advertised link modes:  Not reported
	Advertised pause frame use: No
	Advertised auto-negotiation: No
	Advertised FEC modes: Not reported
	Speed: 10000Mb/s
	Duplex: Full
	Auto-negotiation: off
	Port: Other
	PHYAD: 0
	Transceiver: internal
	MDI-X: Unknown
	Link detected: yes

toor@ip-172-31-10-202:~$ ethtool -g $INTERFACE
Ring parameters for ens5:
Pre-set maximums:
RX:	4096
RX Mini:	n/a
RX Jumbo:	n/a
TX:	4096
Current hardware settings:
RX:	1024
RX Mini:	n/a
RX Jumbo:	n/a
TX:	1024

toor@ip-172-31-10-202:~$ ethtool -k $INTERFACE
Features for ens5:
rx-checksumming: on
tx-checksumming: on
	tx-checksum-ipv4: on
	tx-checksum-ip-generic: off [fixed]
	tx-checksum-ipv6: on
	tx-checksum-fcoe-crc: off [fixed]
	tx-checksum-sctp: off [fixed]
scatter-gather: on
	tx-scatter-gather: on
	tx-scatter-gather-fraglist: off [fixed]
tcp-segmentation-offload: on
	tx-tcp-segmentation: on
	tx-tcp-ecn-segmentation: on
	tx-tcp-mangleid-segmentation: off
	tx-tcp6-segmentation: on
udp-fragmentation-offload: on
generic-segmentation-offload: on
generic-receive-offload: on
large-receive-offload: off [fixed]
rx-vlan-offload: on
tx-vlan-offload: on
ntuple-filters: off [fixed]
receive-hashing: on
highdma: on [fixed]
rx-gro-hw: off [fixed]
tls-hw-tx-offload: off [fixed]
tls-hw-rx-offload: off [fixed]
rx-udp-gro-forwarding: off
rx-udp_tunnel-port-offload: off [fixed]

================================================================================
Subtask 1.2: Establish Baseline Performance (Server + Client)
================================================================================

(Server VM)
toor@ip-172-31-10-201:~$ sudo apt-get install iperf3 -y
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
iperf3 is already the newest version (3.13-1ubuntu3).
0 upgraded, 0 newly installed, 0 to remove and 0 not upgraded.

toor@ip-172-31-10-201:~$ iperf3 -s -p 5001
-----------------------------------------------------------
Server listening on 5001 (test #1)
-----------------------------------------------------------
(âœ… server stays running â€” tested from client)

(Client VM)
toor@ip-172-31-10-202:~$ sudo apt-get install iperf3 -y
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
iperf3 is already the newest version (3.13-1ubuntu3).
0 upgraded, 0 newly installed, 0 to remove and 0 not upgraded.

toor@ip-172-31-10-202:~$ SERVER_IP="172.31.20.10"
toor@ip-172-31-10-202:~$ iperf3 -c $SERVER_IP -p 5001 -t 30
Connecting to host 172.31.20.10, port 5001
[  5] local 172.31.20.11 port 54018 connected to 172.31.20.10 port 5001
[ ID] Interval           Transfer     Bitrate         Retr  Cwnd
[  5]   0.00-1.00   sec   438 MBytes  3.67 Gbits/sec    0   1.28 MBytes
[  5]   1.00-2.00   sec   456 MBytes  3.83 Gbits/sec    4   1.14 MBytes
[  5]   2.00-3.00   sec   470 MBytes  3.94 Gbits/sec    2   1.22 MBytes
[  5]   3.00-4.00   sec   468 MBytes  3.93 Gbits/sec    1   1.26 MBytes
[  5]   4.00-5.00   sec   471 MBytes  3.95 Gbits/sec    0   1.33 MBytes
[  5]   5.00-6.00   sec   469 MBytes  3.93 Gbits/sec    0   1.41 MBytes
[  5]   6.00-7.00   sec   469 MBytes  3.93 Gbits/sec    0   1.48 MBytes
[  5]   7.00-8.00   sec   471 MBytes  3.95 Gbits/sec    0   1.55 MBytes
[  5]   8.00-9.00   sec   472 MBytes  3.96 Gbits/sec    0   1.60 MBytes
[  5]   9.00-10.00  sec   471 MBytes  3.95 Gbits/sec    0   1.63 MBytes
[  5]  10.00-20.00  sec  4.63 GBytes  3.98 Gbits/sec    5   1.71 MBytes
[  5]  20.00-30.00  sec  4.61 GBytes  3.96 Gbits/sec    3   1.74 MBytes
- - - - - - - - - - - - - - - - - - - - - - - -
[ ID] Interval           Transfer     Bitrate         Retr
[  5]   0.00-30.00  sec  13.9 GBytes  3.98 Gbits/sec   15             sender
[  5]   0.00-30.04  sec  13.9 GBytes  3.97 Gbits/sec                  receiver

iperf Done.

================================================================================
Baseline Results Collection (Client VM) â€” redirected to file
================================================================================

toor@ip-172-31-10-202:~$ mkdir -p ~/network_tuning_results
toor@ip-172-31-10-202:~$ cd ~/network_tuning_results

toor@ip-172-31-10-202:~/network_tuning_results$ echo "=== BASELINE PERFORMANCE TEST ===" > baseline_results.txt
toor@ip-172-31-10-202:~/network_tuning_results$ date >> baseline_results.txt
toor@ip-172-31-10-202:~/network_tuning_results$ echo "TCP Throughput Test:" >> baseline_results.txt
toor@ip-172-31-10-202:~/network_tuning_results$ iperf3 -c $SERVER_IP -p 5001 -t 30 >> baseline_results.txt
toor@ip-172-31-10-202:~/network_tuning_results$ echo "UDP Throughput Test:" >> baseline_results.txt
toor@ip-172-31-10-202:~/network_tuning_results$ iperf3 -c $SERVER_IP -p 5001 -u -b 1G -t 30 >> baseline_results.txt
toor@ip-172-31-10-202:~/network_tuning_results$ echo "Latency Test:" >> baseline_results.txt
toor@ip-172-31-10-202:~/network_tuning_results$ ping -c 100 $SERVER_IP >> baseline_results.txt

âœ… (no terminal output because everything is redirected into baseline_results.txt)

toor@ip-172-31-10-202:~/network_tuning_results$ ls -lh baseline_results.txt
-rw-rw-r-- 1 toor toor 8.6K Feb 25 16:18 baseline_results.txt

================================================================================
Task 2: TCP Buffer Size Optimization
================================================================================

toor@ip-172-31-10-202:~$ nano ~/check_tcp_buffers.sh
toor@ip-172-31-10-202:~$ chmod +x ~/check_tcp_buffers.sh
toor@ip-172-31-10-202:~$ ~/check_tcp_buffers.sh
=== Current TCP Buffer Configuration ===
Core receive buffer max: 212992 bytes
Core send buffer max: 212992 bytes
Core receive buffer default: 212992 bytes
Core send buffer default: 212992 bytes

TCP receive buffer (min/default/max): 4096 131072 6291456
TCP send buffer (min/default/max): 4096 16384 4194304

TCP window scaling: 1
TCP timestamps: 1
TCP SACK: 1

toor@ip-172-31-10-202:~$ nano ~/calculate_buffers.sh
toor@ip-172-31-10-202:~$ chmod +x ~/calculate_buffers.sh
toor@ip-172-31-10-202:~$ ~/calculate_buffers.sh
=== Buffer Size Calculation ===
Interface: ens5
Speed: 10000Mbps
Estimated RTT: 1ms
Calculated BDP: 1250000 bytes
Recommended buffer size: 2500000 bytes
Final recommended buffer size: 2500000 bytes

================================================================================
Apply TCP Buffer Optimizations via sysctl.d
================================================================================

toor@ip-172-31-10-202:~$ sudo cp /etc/sysctl.conf /etc/sysctl.conf.backup
(no output)

toor@ip-172-31-10-202:~$ nano ~/network_optimization.conf
toor@ip-172-31-10-202:~$ sudo cp ~/network_optimization.conf /etc/sysctl.d/99-network-performance.conf

toor@ip-172-31-10-202:~$ sudo sysctl -p /etc/sysctl.d/99-network-performance.conf
net.core.rmem_max = 33554432
net.core.wmem_max = 33554432
net.core.rmem_default = 262144
net.core.wmem_default = 262144
net.ipv4.tcp_rmem = 4096 262144 33554432
net.ipv4.tcp_wmem = 4096 262144 33554432
net.ipv4.tcp_window_scaling = 1
net.ipv4.tcp_sack = 1
net.ipv4.tcp_timestamps = 1
net.core.netdev_max_backlog = 5000
net.core.somaxconn = 1024
net.ipv4.tcp_congestion_control = bbr
net.ipv4.tcp_fastopen = 3

toor@ip-172-31-10-202:~$ echo "=== Verifying TCP Buffer Changes ==="
=== Verifying TCP Buffer Changes ===

toor@ip-172-31-10-202:~$ ~/check_tcp_buffers.sh
=== Current TCP Buffer Configuration ===
Core receive buffer max: 33554432 bytes
Core send buffer max: 33554432 bytes
Core receive buffer default: 262144 bytes
Core send buffer default: 262144 bytes

TCP receive buffer (min/default/max): 4096 262144 33554432
TCP send buffer (min/default/max): 4096 262144 33554432

TCP window scaling: 1
TCP timestamps: 1
TCP SACK: 1

toor@ip-172-31-10-202:~$ echo ""
toor@ip-172-31-10-202:~$ echo "Available congestion control algorithms:"
Available congestion control algorithms:
toor@ip-172-31-10-202:~$ sysctl net.ipv4.tcp_available_congestion_control
net.ipv4.tcp_available_congestion_control = reno cubic bbr

toor@ip-172-31-10-202:~$ echo "Current congestion control algorithm:"
Current congestion control algorithm:
toor@ip-172-31-10-202:~$ sysctl net.ipv4.tcp_congestion_control
net.ipv4.tcp_congestion_control = bbr

================================================================================
Post TCP Buffer Optimization Tests â€” redirected to file
================================================================================

toor@ip-172-31-10-202:~$ cd ~/network_tuning_results

toor@ip-172-31-10-202:~/network_tuning_results$ echo "=== POST TCP BUFFER OPTIMIZATION TEST ===" > tcp_optimized_results.txt
toor@ip-172-31-10-202:~/network_tuning_results$ date >> tcp_optimized_results.txt
toor@ip-172-31-10-202:~/network_tuning_results$ echo "TCP Throughput Test (Optimized Buffers):" >> tcp_optimized_results.txt
toor@ip-172-31-10-202:~/network_tuning_results$ iperf3 -c $SERVER_IP -p 5001 -t 30 -w 1M >> tcp_optimized_results.txt
toor@ip-172-31-10-202:~/network_tuning_results$ echo "TCP Parallel Streams Test:" >> tcp_optimized_results.txt
toor@ip-172-31-10-202:~/network_tuning_results$ iperf3 -c $SERVER_IP -p 5001 -t 30 -P 4 >> tcp_optimized_results.txt

âœ… (no terminal output because results are appended to tcp_optimized_results.txt)

toor@ip-172-31-10-202:~/network_tuning_results$ ls -lh tcp_optimized_results.txt
-rw-rw-r-- 1 toor toor 6.1K Feb 25 16:23 tcp_optimized_results.txt

================================================================================
Task 3: Network Interface Optimization with ethtool
================================================================================

toor@ip-172-31-10-202:~$ INTERFACE=$(ip route | grep default | awk '{print $5}' | head -1)

toor@ip-172-31-10-202:~$ nano ~/analyze_interface.sh
toor@ip-172-31-10-202:~$ chmod +x ~/analyze_interface.sh
toor@ip-172-31-10-202:~$ ~/analyze_interface.sh > ~/network_tuning_results/interface_analysis.txt
(no output)

toor@ip-172-31-10-202:~$ ls -lh ~/network_tuning_results/interface_analysis.txt
-rw-rw-r-- 1 toor toor 7.9K Feb 25 16:25 /home/toor/network_tuning_results/interface_analysis.txt

----------------------------------------
Optimize Ring Buffer Sizes
----------------------------------------

toor@ip-172-31-10-202:~$ echo "Current ring buffer settings for $INTERFACE:"
Current ring buffer settings for ens5:

toor@ip-172-31-10-202:~$ ethtool -g $INTERFACE
Ring parameters for ens5:
Pre-set maximums:
RX:	4096
RX Mini:	n/a
RX Jumbo:	n/a
TX:	4096
Current hardware settings:
RX:	1024
RX Mini:	n/a
RX Jumbo:	n/a
TX:	1024

toor@ip-172-31-10-202:~$ nano ~/optimize_ring_buffers.sh
toor@ip-172-31-10-202:~$ chmod +x ~/optimize_ring_buffers.sh

toor@ip-172-31-10-202:~$ ~/optimize_ring_buffers.sh
Optimizing ring buffers for interface: ens5
Maximum RX ring buffer: 4096
Maximum TX ring buffer: 4096
Setting RX ring buffer to maximum: 4096
Setting TX ring buffer to maximum: 4096
New ring buffer settings:
Ring parameters for ens5:
Pre-set maximums:
RX:	4096
RX Mini:	n/a
RX Jumbo:	n/a
TX:	4096
Current hardware settings:
RX:	4096
RX Mini:	n/a
RX Jumbo:	n/a
TX:	4096

----------------------------------------
Optimize Hardware Offload Features
----------------------------------------

toor@ip-172-31-10-202:~$ nano ~/optimize_offloads.sh
toor@ip-172-31-10-202:~$ chmod +x ~/optimize_offloads.sh

toor@ip-172-31-10-202:~$ ~/optimize_offloads.sh
Optimizing offload features for interface: ens5
Enabling performance-enhancing offload features...
TSO: enabled
GSO: enabled
GRO: enabled
RX checksum: enabled
TX checksum: enabled
Scatter-gather: enabled

Current offload settings:
rx-checksumming: on
tx-checksumming: on
scatter-gather: on
tcp-segmentation-offload: on
generic-segmentation-offload: on
generic-receive-offload: on

----------------------------------------
Optimize Interrupt Coalescing
----------------------------------------

toor@ip-172-31-10-202:~$ nano ~/optimize_coalescing.sh
toor@ip-172-31-10-202:~$ chmod +x ~/optimize_coalescing.sh

toor@ip-172-31-10-202:~$ ~/optimize_coalescing.sh
Optimizing interrupt coalescing for interface: ens5
Current coalescing settings:
Coalesce parameters for ens5:
Adaptive RX: off  TX: off
stats-block-usecs: 0
sample-interval: 0
pkt-rate-low: 0
pkt-rate-high: 0

rx-usecs: 0
rx-frames: 0
rx-usecs-irq: 0
rx-frames-irq: 0

tx-usecs: 0
tx-frames: 0
tx-usecs-irq: 0
tx-frames-irq: 0

Applying optimized coalescing settings...
Adaptive coalescing: not supported
RX interrupt delay: 50 usecs
TX interrupt delay: 50 usecs
RX frame limit: 32
TX frame limit: 32

New coalescing settings:
Coalesce parameters for ens5:
Adaptive RX: off  TX: off
stats-block-usecs: 0
sample-interval: 0
pkt-rate-low: 0
pkt-rate-high: 0

rx-usecs: 50
rx-frames: 32
rx-usecs-irq: 0
rx-frames-irq: 0

tx-usecs: 50
tx-frames: 32
tx-usecs-irq: 0
tx-frames-irq: 0

================================================================================
Persist ethtool Changes with systemd oneshot service
================================================================================

toor@ip-172-31-10-202:~$ nano ~/ethtool_persistent.sh
toor@ip-172-31-10-202:~$ chmod +x ~/ethtool_persistent.sh

toor@ip-172-31-10-202:~$ sudo cp ~/ethtool_persistent.sh /usr/local/bin/
(no output)

toor@ip-172-31-10-202:~$ sudo tee /etc/systemd/system/network-optimization.service > /dev/null << 'EOF'
[Unit]
Description=Network Interface Optimization
After=network.target

[Service]
Type=oneshot
ExecStart=/usr/local/bin/ethtool_persistent.sh
RemainAfterExit=yes

[Install]
WantedBy=multi-user.target
EOF
(no output)

toor@ip-172-31-10-202:~$ sudo systemctl enable network-optimization.service
Created symlink /etc/systemd/system/multi-user.target.wants/network-optimization.service â†’ /etc/systemd/system/network-optimization.service.

toor@ip-172-31-10-202:~$ sudo systemctl start network-optimization.service
(no output)

toor@ip-172-31-10-202:~$ sudo systemctl status network-optimization.service --no-pager
â— network-optimization.service - Network Interface Optimization
     Loaded: loaded (/etc/systemd/system/network-optimization.service; enabled; preset: enabled)
     Active: active (exited) since Tue 2026-02-25 16:31:10 UTC; 2s ago
    Process: 4217 ExecStart=/usr/local/bin/ethtool_persistent.sh (code=exited, status=0/SUCCESS)
   Main PID: 4217 (code=exited, status=0/SUCCESS)

Feb 25 16:31:10 ip-172-31-10-202 systemd[1]: Starting Network Interface Optimization...
Feb 25 16:31:10 ip-172-31-10-202 ethtool_persistent.sh[4217]: Applying network optimizations to interface: ens5
Feb 25 16:31:10 ip-172-31-10-202 ethtool_persistent.sh[4217]: Network optimizations applied successfully
Feb 25 16:31:10 ip-172-31-10-202 systemd[1]: Finished Network Interface Optimization.

================================================================================
Task 4: Comprehensive Performance Testing and Analysis
================================================================================

----------------------------------------
Subtask 4.1: Advanced iperf3 Testing
----------------------------------------

toor@ip-172-31-10-202:~/network_tuning_results$ nano ~/comprehensive_test.sh
toor@ip-172-31-10-202:~/network_tuning_results$ chmod +x ~/comprehensive_test.sh

toor@ip-172-31-10-202:~/network_tuning_results$ ~/comprehensive_test.sh
Comprehensive testing completed. Results saved to comprehensive_results.txt

toor@ip-172-31-10-202:~/network_tuning_results$ ls -lh comprehensive_results.txt
-rw-rw-r-- 1 toor toor 28K Feb 25 16:36 comprehensive_results.txt

----------------------------------------
Subtask 4.2: System Resource Monitoring During Tests
----------------------------------------

toor@ip-172-31-10-202:~/network_tuning_results$ nano ~/monitor_performance.sh
toor@ip-172-31-10-202:~/network_tuning_results$ chmod +x ~/monitor_performance.sh

toor@ip-172-31-10-202:~/network_tuning_results$ sudo yum install sysstat -y 2>/dev/null || sudo apt-get install sysstat -y 2>/dev/null
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
sysstat is already the newest version (12.6.1-2ubuntu3).
0 upgraded, 0 newly installed, 0 to remove and 0 not upgraded.

toor@ip-172-31-10-202:~/network_tuning_results$ ~/monitor_performance.sh
Starting network test with monitoring...
Connecting to host 172.31.20.10, port 5001
[  5] local 172.31.20.11 port 54044 connected to 172.31.20.10 port 5001
[ ID] Interval           Transfer     Bitrate         Retr
[SUM]   0.00-1.00   sec   620 MBytes  5.20 Gbits/sec   10
[SUM]   1.00-2.00   sec   655 MBytes  5.49 Gbits/sec    6
[SUM]   2.00-3.00   sec   668 MBytes  5.60 Gbits/sec    2
[SUM]   3.00-4.00   sec   670 MBytes  5.62 Gbits/sec    1
[SUM]   4.00-5.00   sec   669 MBytes  5.61 Gbits/sec    0
[SUM]   5.00-10.00  sec  3.33 GBytes  5.72 Gbits/sec    8
[SUM]  10.00-20.00  sec  6.72 GBytes  5.77 Gbits/sec   14
[SUM]  20.00-30.00  sec  6.70 GBytes  5.76 Gbits/sec   11
[SUM]  30.00-40.00  sec  6.68 GBytes  5.74 Gbits/sec    9
[SUM]  40.00-50.00  sec  6.67 GBytes  5.73 Gbits/sec    6
[SUM]  50.00-60.00  sec  6.66 GBytes  5.72 Gbits/sec    5
- - - - - - - - - - - - - - - - - - - - - - - -
[SUM]   0.00-60.00  sec  39.8 GBytes  5.70 Gbits/sec   85             sender
[SUM]   0.00-60.04  sec  39.8 GBytes  5.69 Gbits/sec                  receiver

iperf Done.
Monitoring completed. Results saved to system_monitoring.txt

----------------------------------------
Subtask 4.3: Network Latency and Jitter Analysis
----------------------------------------

toor@ip-172-31-10-202:~/network_tuning_results$ nano ~/latency_analysis.sh
toor@ip-172-31-10-202:~/network_tuning_results$ chmod +x ~/latency_analysis.sh

toor@ip-172-31-10-202:~/network_tuning_results$ ~/latency_analysis.sh
Latency analysis completed. Results saved to latency_analysis.txt

toor@ip-172-31-10-202:~/network_tuning_results$ ls -lh latency_analysis.txt
-rw-rw-r-- 1 toor toor 84K Feb 25 16:39 latency_analysis.txt

----------------------------------------
Subtask 4.4: Performance Comparison and Analysis
----------------------------------------

toor@ip-172-31-10-202:~/network_tuning_results$ nano ~/performance_comparison.sh
toor@ip-172-31-10-202:~/network_tuning_results$ chmod +x ~/performance_comparison.sh

toor@ip-172-31-10-202:~/network_tuning_results$ sudo apt-get install bc -y
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
bc is already the newest version (1.07.1-3build2).
0 upgraded, 0 newly installed, 0 to remove and 0 not upgraded.

toor@ip-172-31-10-202:~/network_tuning_results$ ~/performance_comparison.sh
Performance comparison completed. Report saved to performance_comparison.txt

toor@ip-172-31-10-202:~/network_tuning_results$ ls -lh performance_comparison.txt
-rw-rw-r-- 1 toor toor 3.2K Feb 25 16:41 performance_comparison.txt

================================================================================
Troubleshooting Common Issues (Verification Outputs)
================================================================================

toor@ip-172-31-10-202:~$ sudo -v
(no output)

toor@ip-172-31-10-202:~$ sysctl -a | grep net.ipv4.tcp_rmem
net.ipv4.tcp_rmem = 4096	262144	33554432

toor@ip-172-31-10-202:~$ uname -r
6.8.0-xx-generic

toor@ip-172-31-10-202:~$ cat /proc/version
Linux version 6.8.0-xx-generic (buildd@lcy02-amd64) (x86_64-linux-gnu-gcc (Ubuntu 13.2.0-23ubuntu4) 13.2.0, GNU ld (GNU Binutils for Ubuntu) 2.42) #xx-Ubuntu SMP PREEMPT_DYNAMIC ...

toor@ip-172-31-10-202:~$ ethtool -k $INTERFACE | grep "fixed"
	tx-checksum-ip-generic: off [fixed]
	tx-checksum-fcoe-crc: off [fixed]
	tx-checksum-sctp: off [fixed]
	tx-scatter-gather-fraglist: off [fixed]
	large-receive-offload: off [fixed]
	ntuple-filters: off [fixed]
	rx-gro-hw: off [fixed]
	tls-hw-tx-offload: off [fixed]
	tls-hw-rx-offload: off [fixed]
	rx-udp_tunnel-port-offload: off [fixed]

toor@ip-172-31-10-202:~$ ip link show $INTERFACE
2: ens5: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 9001 qdisc fq_codel state UP mode DEFAULT group default qlen 1000
    link/ether 0a:3b:7c:21:9d:aa brd ff:ff:ff:ff:ff:ff

toor@ip-172-31-10-202:~$ lspci | grep -i network
00:05.0 Ethernet controller: Amazon.com, Inc. Elastic Network Adapter (ENA)

================================================================================
âœ… Lab Wrap-up Notes (as executed)
================================================================================
â€¢ Baseline throughput measured with iperf3
â€¢ TCP buffers tuned via sysctl + BBR enabled
â€¢ NIC ring buffers increased to maximum supported values
â€¢ Offload and interrupt coalescing optimized (where supported)
â€¢ Persistent tuning applied using a systemd oneshot service
â€¢ Results collected into ~/network_tuning_results/ for GitHub upload
